---
title: Optimalizace
description: PrÅ¯vodce optimalizacÃ­ serveru Minecraft pro maximÃ¡lnÃ­ vÃ½kon.
---


import {CardGrid, LinkCard, Steps, FileTree} from '@astrojs/starlight/components';

Tento prÅ¯vodce je urÄen primÃ¡rnÄ› pro verzi **1.21.x**, ale vÄ›tÅ¡ina informacÃ­ platÃ­ i pro starÅ¡Ã­ verze (1.18+).

:::note[ZlatÃ© pravidlo]
Nikdy nebude existovat jeden univerzÃ¡lnÃ­ nÃ¡vod, kterÃ½ pÅ™inese perfektnÃ­ vÃ½sledky pro vÅ¡echny. KaÅ¾dÃ½ server mÃ¡ jinÃ© potÅ™eby (Survival vs. Skyblock) a jinÃ½ hardware. LadÄ›nÃ­ moÅ¾nostÃ­ pro tvÅ¯j konkrÃ©tnÃ­ server je klÃ­Äem.
:::

## 1. VÃ½bÄ›r Softwaru

Volba serverovÃ©ho software (JAR) mÃ¡ **nejvÄ›tÅ¡Ã­ vliv** na vÃ½kon.

<CardGrid>
    <LinkCard title="Paper" description="ZlatÃ½ standard. ZamÄ›Å™enÃ½ na vÃ½kon a opravy hernÃ­ch mechanik."
              href="https://papermc.io/downloads" target="_blank"/>
    <LinkCard title="Pufferfish" description="Fork Paperu s agresivnÃ­ optimalizacÃ­. SkvÄ›lÃ½ pro vÄ›tÅ¡Ã­ servery."
              href="https://pufferfish.host/downloads" target="_blank"/>
    <LinkCard title="Purpur" description="Fork Pufferfish s dÅ¯razem na hernÃ­ moÅ¾nosti a konfigurovatelnost."
              href="https://purpurmc.org/downloads" target="_blank"/>
    <LinkCard title="Leaf" description="NovÄ›jÅ¡Ã­ fork zamÄ›Å™enÃ½ na opravy a dalÅ¡Ã­ optimalizace."
              href="https://www.leafmc.one/download" target="_blank"/>
</CardGrid>

:::danger[ÄŒemu se vyhnout?]
* **Vanilla / CraftBukkit / Spigot:** ZastaralÃ© a neefektivnÃ­.
* **"Async" forky:** PlacenÃ© JARy slibujÃ­cÃ­ "vÅ¡echno asynchronnÄ›" jsou Äasto podvody nebo extrÃ©mnÄ› nestabilnÃ­.
* **Reloadery:** Pluginy jako PlugMan pro "reload" pluginÅ¯ za bÄ›hu Äasto zpÅ¯sobujÃ­ chyby a Ãºniky pamÄ›ti.
:::

## 2. PÅ™edgenerovÃ¡nÃ­ mapy

Generace novÃ©ho svÄ›ta (1.18+) je extrÃ©mnÄ› nÃ¡roÄnÃ¡ na procesor. Pokud hrÃ¡Ä bÄ›Å¾Ã­ do neprozkoumanÃ©ho ÃºzemÃ­, server se zaÄne sekat.

**Å˜eÅ¡enÃ­:** PÅ™edgeneruj mapu pomocÃ­ pluginu **Chunky**.
<Steps>
    1.  Nainstaluj [Chunky](https://hangar.papermc.io/pop4959/Chunky).
    2.  Nastav hranice svÄ›ta (WorldBorder).
    3.  SpusÅ¥ generovÃ¡nÃ­ pÅ™Ã­kazem `chunky start`.
</Steps>

:::tip[Tip]
NezapomeÅˆ nastavit hranice i pro Nether a End! Nether je 8Ã— menÅ¡Ã­ neÅ¾ Overworld. Pokud nastavÃ­Å¡ Overworld na 10 000 blokÅ¯, Nether nastav na 1 250.
:::

## 3. Konfigurace serveru

Zde jsou nejdÅ¯leÅ¾itÄ›jÅ¡Ã­ nastavenÃ­, kterÃ¡ majÃ­ nejvÄ›tÅ¡Ã­ dopad na vÃ½kon.

### server.properties

<FileTree>
- **server.properties**
</FileTree>

* **`simulation-distance`** (DoporuÄeno: **4**)
* UrÄuje, jak daleko od hrÃ¡Äe server "poÄÃ­tÃ¡ fyziku" (rÅ¯st obilÃ­, pece, mobovÃ©).
* Toto je **nejdÅ¯leÅ¾itÄ›jÅ¡Ã­ nastavenÃ­ pro vÃ½kon**. Hodnota 3 nebo 4 je ideÃ¡lnÃ­ pro vÄ›tÅ¡inu serverÅ¯.
* **`view-distance`** (DoporuÄeno: **7-10**)
* Jak daleko hrÃ¡Äi vidÃ­. Tuto hodnotu nastav vyÅ¡Å¡Ã­ neÅ¾ `simulation-distance`. Paper umÃ­ posÃ­lat chunky, aniÅ¾ by je zatÄ›Å¾oval (tickoval).
* **`network-compression-threshold`** (DoporuÄeno: **256**)
* Velikost paketu pro kompresi. Pro veÅ™ejnÃ© servery nech 256. Pokud mÃ¡Å¡ BungeeCord na stejnÃ©m stroji, zvaÅ¾ -1 (vypnuto).

### spigot.yml

<FileTree>
- **spigot.yml**
</FileTree>

* **`mob-spawn-range`** (DoporuÄeno: **3**)
* Okruh spawnovÃ¡nÃ­ mobÅ¯. MusÃ­ bÃ½t menÅ¡Ã­ nebo rovno `simulation-distance`. SnÃ­Å¾enÃ­ vÃ½raznÄ› pomÃ¡hÃ¡ s vÃ½konem AI.
* **`entity-activation-range`**
* MobovÃ© mimo tuto vzdÃ¡lenost nebudou mÃ­t aktivnÃ­ AI (nebudou se hÃ½bat).
```yaml
animals: 16
monsters: 24
raiders: 48
misc: 8
tick-inactive-villagers: false # Pozor: MÅ¯Å¾e rozbÃ­t farmy na Å¾elezo.
ignore-spectators: true
```
* **`merge-radius`** (DoporuÄeno: `item: 3.5`, `exp: 4.0`)
* Spojuje itemy na zemi do jednoho stacku. MÃ©nÄ› entit = menÅ¡Ã­ lagy.

### config/paper-world-defaults.yml
*(DÅ™Ã­ve paper.yml)*

<FileTree>
- config/
  - **paper-world-defaults.yml**
</FileTree>

* **`max-entity-collisions`** (DoporuÄeno: **2**)
* Kolik entit se mÅ¯Å¾e "strkat" najednou. Hodnota 2 staÄÃ­ pro vÄ›tÅ¡inu farem a zabrÃ¡nÃ­ lagÅ¯m pÅ™i pÅ™emnoÅ¾enÃ­ mobÅ¯ na jednom bloku.
* **`despawn-ranges`** (Soft / Hard)
* **Monster:** 32 / 96
* MobovÃ© dÃ¡le neÅ¾ Hard limit zmizÃ­ okamÅ¾itÄ›. Hard limit by mÄ›l bÃ½t mÃ­rnÄ› vÄ›tÅ¡Ã­ neÅ¾ `simulation-distance * 16`.
* **`per-player-mob-spawns`** (DoporuÄeno: **true**)
* ZajiÅ¡Å¥uje spravedlivÃ© rozdÄ›lenÃ­ mobÅ¯. ZabrÃ¡nÃ­ tomu, aby jeden hrÃ¡Ä u mob farmy vyÄerpal celÃ½ limit serveru.
* **`redstone-implementation`** (DoporuÄeno: **ALTERNATE_CURRENT**)
* Mnohem efektivnÄ›jÅ¡Ã­ algoritmus pro redstone. SniÅ¾uje lagy z velkÃ½ch obvodÅ¯ aÅ¾ o 80 %.
* **`optimize-explosions`** (DoporuÄeno: **true**)
* RychlejÅ¡Ã­ vÃ½poÄet TNT.
* **`treasure-maps.enabled`** (DoporuÄeno: **false**)
* HledÃ¡nÃ­ pokladÅ¯ (mapy k vrakÅ¯m) je ÄastÃ½m dÅ¯vodem zamrznutÃ­ serveru pÅ™i generaci svÄ›ta. Pokud nemÃ¡Å¡ svÄ›t 100% pÅ™edgenerovanÃ½, vypni to.

### purpur.yml
*(Pouze pro Purpur)*

<FileTree>
- **purpur.yml**
</FileTree>

* **`zombie.aggressive-towards-villager-when-lagging`** (DoporuÄeno: **false**)
* Pokud TPS klesne, zombÃ­ci pÅ™estanou hledat vesniÄany.
* **`villager.lobotomize.enabled`** (DoporuÄeno: **true**)
* VesniÄanÃ©, kteÅ™Ã­ nemohou najÃ­t cestu nebo jsou zavÅ™enÃ­ v 1x1 prostoru, ztratÃ­ AI a pÅ™estanou zatÄ›Å¾ovat server.

## 4. Java Flagy (StartovacÃ­ argumenty)

**âš ï¸ DÅ¯leÅ¾itÃ©:** Minecraft 1.21 vyÅ¾aduje **Java 21**.

NepouÅ¾Ã­vej vÃ½chozÃ­ parametry. PouÅ¾Ã­vej **Aikar's Flags**, kterÃ© jsou prÅ¯myslovÃ½m standardem pro optimalizaci Garbage Collectoru (G1GC).

<LinkCard title="GenerÃ¡tor FlagÅ¯" description="Vygeneruj si sprÃ¡vnÃ© argumenty pro svÅ¯j hardware."
          href="https://flags.sh/" target="_blank" icon="rocket"/>

PodrobnÄ›jÅ¡Ã­ nÃ¡vod najdeÅ¡ v sekci [Java Flagy](/nastaveni/java-flagy/).

## 5. MÄ›Å™enÃ­ vÃ½konu (Lagy?)

NehÃ¡dej, co zpÅ¯sobuje lagy. ZmÄ›Å™ to.
<Steps>
    1.  **`/mspt`**
        * PÅ™Ã­kaz Paperu. UkÃ¡Å¾e prÅ¯mÄ›rnou dÃ©lku ticku.
        * Pod **50ms** = âœ… OK (20 TPS)
        * Nad **50ms** = âš ï¸ Lagy (TPS klesÃ¡)
    2.  **Spark**
        * [Spark](https://spark.lucko.me/download) je nejlepÅ¡Ã­ nÃ¡stroj na analÃ½zu. Je souÄÃ¡stÃ­ Paperu.
        * NapiÅ¡ `/spark profiler start`, nech bÄ›Å¾et cca 5 minut pÅ™i lagÃ¡ch a pak `/spark profiler stop`. DostaneÅ¡ odkaz, kde pÅ™esnÄ› uvidÃ­Å¡, kterÃ½ plugin nebo entita "Å¾ere" vÃ½kon.
</Steps>
## 6. MÃ½ty a nebezpeÄnÃ© "optimalizace"

ğŸš« **Pluginy na mazÃ¡nÃ­ itemÅ¯ (ClearLag)**
ZbyteÄnÃ©. VÄ›tÅ¡inou zpÅ¯sobÃ­ vÃ­ce lagÅ¯ skenovÃ¡nÃ­m svÄ›ta, neÅ¾ kolik uÅ¡etÅ™Ã­ smazÃ¡nÃ­m itemÅ¯. PouÅ¾ij radÄ›ji nastavenÃ­ `alt-item-despawn-rate` v configu Paperu (napÅ™. cobblestone zmizÃ­ po 30s).

ğŸš« **Reload (`/reload` nebo PlugMan)**
Nikdy nepouÅ¾Ã­vej `/reload` na produkÄnÃ­m serveru. RozbÃ­jÃ­ to pluginy, zpÅ¯sobuje Ãºniky pamÄ›ti (memory leaks) a chyby v datech. **VÅ¾dy server restartujte.**